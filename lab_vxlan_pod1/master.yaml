clab_name: vxlan_pod1
drawio_diagram: topology.drawio

# Continerlab parameters
clab_startup:
  ios:
    image: vrnetlab/cisco_csr1000v:17.03.08
    kind: cisco_csr1000v
    startup-config: ios_initial_cfg.j2
    env:
      # this is required for correct assignment of mgmt address (otherwise each node gets 10.0.0.15)
      CLAB_MGMT_PASSTHROUGH: true
  n9kv:
    image: vrnetlab/cisco_n9kv:10.4.5
    kind: cisco_n9kv
    startup-config: nxos_ssh_initial_cfg.j2
    env:
      VCPU: 4
      RAM: 10240
      # this is required for correct assignment of mgmt address (otherwise each node gets 10.0.0.15)
      CLAB_MGMT_PASSTHROUGH: true
# Nornir parameters
nornir_startup:
  ios:
    platform: ios
  nxos_ssh:
    platform: nxos_ssh
  linux:
    platform: linux
  inventory:
    plugin: SimpleInventory
    options:
      host_file: 'nornir/nornir_hosts.yaml'
      group_file: 'nornir/nornir_groups.yaml'
  runner:
    plugin: threaded
    options:
      num_workers: 10
  logging:
    log_file: nornir/nornir.log

# Parameters specific to each vendor/device type
device_groups:
  ios:
    username: clab
    password: clab@123
    clab:
      inherit_from: clab_startup.ios
    nornir:
      inherit_from: nornir_startup.ios
    # this is used for auto-allocation of interface IDs
    intf_naming:
      default:
        name: Gi
        first_id: 2
      core_bundle: 
        name: BE
        first_id: 1
      loopback0:
        name: Loopback
        first_id: 0
    interfaces:
      mgmt:
        name: GigabitEthernet1

  n9kv:
    # use default clab credentials, because these are baked into n9kv docker image!
    username: admin
    password: admin
    clab:
      inherit_from: clab_startup.n9kv
    nornir:
      inherit_from: nornir_startup.nxos_ssh
    # intf_naming is used for auto-allocation of interface IDs for specific interface type
    intf_naming:
      default:
        name: Ethernet1/
        first_id: 1
      loopback0:
        name: Loopback
        first_id: 0
    interfaces:
      mgmt:
        name: mgmt0

# List of all devices with inherited vendor-specific (device_groups) and role-specific (device_roles) inventory
devices:
  spine1:
    device_roles: [spine]
    inherit_from: 
      - device_groups.n9kv
  spine2:
    device_roles: [spine]
    inherit_from: 
      - device_groups.n9kv
  leaf1:
    device_roles: [leaf]
    inherit_from: 
      - device_groups.n9kv
  leaf2:
    device_roles: [leaf]
    inherit_from: 
      - device_groups.n9kv
  leaf3:
    device_roles: [leaf]
    inherit_from: 
      - device_groups.n9kv
  leaf4:
    device_roles: [leaf]
    inherit_from: 
      - device_groups.n9kv
  cpe1:
    device_roles: [cpe]
    inherit_from: 
      - device_groups.ios
  cpe2:
    device_roles: [cpe]
    inherit_from: 
      - device_groups.ios

# Link-group parameters
link_groups:
  fabric:
    link_group: fabric
    prefix: 1.0.0.0/16
    isis: 
      instance: FABRIC
  access:
    link_group: access
    prefix: 1.1.0.0/16
    mtu: 1505
  loopback0:
    link_group: loopback0
    prefix: 1.255.0.0/24
  mgmt:
    # If you're starting multiple clabs, you must use different mgmt prefix for each clab instance
    link_group: mgmt
    prefix: 10.255.11.0/24

# Topology definition
# - parallel links are allowed
# - loopback0 and MgmtEth interfaces will be generated by lab_create.py
# - ensure that all nodes are first defined in "devices:" object
links:
  # spine1
  - link: spine1---leaf1
    inherit_from: link_groups.fabric
  - link: spine1---leaf2
    inherit_from: link_groups.fabric
  - link: spine1---leaf3
    inherit_from: link_groups.fabric
  - link: spine1---leaf4
    inherit_from: link_groups.fabric
  # spine2
  - link: spine2---leaf1
    inherit_from: link_groups.fabric
  - link: spine2---leaf2
    inherit_from: link_groups.fabric
  - link: spine2---leaf3
    inherit_from: link_groups.fabric
  - link: spine2---leaf4
    inherit_from: link_groups.fabric
  # cpe1
  - link: leaf1---cpe1
    inherit_from: link_groups.access
  - link: leaf2---cpe1
    inherit_from: link_groups.access
  # cpe2
  - link: leaf3---cpe2
    inherit_from: link_groups.access
  - link: leaf4---cpe2
    inherit_from: link_groups.access